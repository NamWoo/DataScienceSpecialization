0:00
One way that you might get a data set is that somebody might actually write down the numbers on a piece of paper and mail to you. But more likely in this era of the internet, you're probably going to be downloading a lot of your data from the Internet. So this lecture is about how do you use r to download files? And the reason why we want to use r to download files as opposed to pointing and clicking, is because then the downloading process can be included in a processing script, and so you get a more complete picture of how the data were collected and generated. So the first thing to keep in mind is that we need to know what directories we're working in. So if you took the Data Scientist Toolbox, you learned a little bit about CD and the current working directories, and moving around within the directories. So the two main commands when we're dealing with directories in r are going to be getwd, and setwd. And so, getwd does exactly what you'd expect, it gets the working directory. It tells you what directory you're currently in. And setwd actually sets a different working directory that you might want to move to. So one way that you can do that, is you can actually use it move relative. So for example if you do setwd("../") like this, what'll end up happening is you'll move it up one directory. So remember when we were talking about directory structure, directory is up if it's a super center, if it's above the directory that you're currently in. You can also use absolute paths. So for example, you can type setwd("/Users/jtleek/data/") and what that'll do is that will move you into that directory that you specified there exactly.
1:32
So an important distinction in Windows is that you have to use backslashes rather than forward slashes. So this is an example of the way that a path might look in a Windows machine as opposed to a Mac or Linux machine. So if you need more help with that go check out the Data Science Toolbox lectures. So one thing that we might want to do before we collect a bit of data is to create a directory for that data to fall into. So file.exists, is a function in r. So if you are in a directory and you type file.exists, directoryName like this, it will look within that directory and see if there is a sub-directory called directoryName.
2:13
And so if it does exist it will return true, and if it doesn't exist it will return false. And so dir.create, like this, will actually create a directory if it doesn't exist. So here's a little bit of code that checks to see if there's a data directory. So it says, if the data sub-directory exists,
2:37
then this will return a true, and so what will end up happening is this will be false, and nothing will happen. If the data directory doesn't exist, this will return false, and this exclamation point will negate it and so that will be true. And so then it will create a directory called data. So you'll be seeing a command a lot like this throughout the lecture and that's where you create a data directory that doesn't already exist. So the main way that we get data from the internet if were talking about files, is with the download.file function, and so the download.file function downloads the file from the internet. You can do this by hand of course, you can go to the website that you're interested in and click and press download. But if you do it by using download.cloud, it'll actually improve the reproducibility if you've taken that class you'll understand what I mean by that. And if not it'll just, you can imagine intuitively it's easier to keep track of everything that you've done if you've included the download process as part of your script.
3:41
The important parameters are the URL, so that's the, the place that you're going to be getting the data from. The destfile is the destination file where that data is going to go, and then the method. So we'll talk a little bit about why the method needs to be specified, particularly when dealing with HTTPS.
3:58
So it's useful for downloading tab to limited, CSV files, Excel files, a whole bunch of other different files from the internet. So it's sort of agnostic to the file type that you might be downloading. So as an example, we're going to be using the Baltimore fixed camera data. So these are speed cameras that are set up around Baltimore, which have unfortunately caught your instructor more than once speeding and being sent in a ticket. And so you might want to be able to download these data and figure out where they are. So if you go over here under the Export button on this website, you actually get a bunch of different kinds of files. And so for example, you might go down to CSV which is one of these types of files that you would see over here on the right hand side. And if you right click you can copy the link address. So now that's the link address just to the CSV file that we might want to download with these camera positions.
4:49
And so, then what we do is we take that link that we copied and we put it right here. We save it into a variable called fileUrl just like this.
4:59
And then we pass a download file that file url that we collected off the website. And we say, we'd like to put it in this data directory and we'd like to call it cameras.csv. We're using .csv because that's the extension that's used for comma separated files. And the method that we're going to use is curl. This is necessary because this website is an https, secure website, and so if you're doing this from a Mac, you need to specify the method is curl in order for it to work. If you're working from Windows, I don't think that you need to set the method to be curl, the default method will work all right for you. So then if you list the files in this data directory, so this is sort of like the LS command that we saw in the command line interface. You see that we now have one file in that directory, and it's the cameras.csv file.
5:49
An important component of downloading files from the internet is that those files might change. So for example, if they update the cameras, there might be a new set of cameras and the data that we're analyzing might be different. So you want to keep track of the date that you downloaded the data, and you can do that with the date function. So you just assign to dateDownloaded the command date and that will give you the date that those data were downloaded. So with those data having been downloaded, and knowing the date, you can go back and see if you can find the right version of the file if you have trouble later on.
6:22
So, if the url starts with http, you should be okay. Even if the url starts with https on Windows you should be okay. On a Mac you need to set the method = "curl" if you have https. One thing to keep in mind is that this actually going out and downloading the file from the Internet, so depending on the size of the file and your internet connection, this could end up taking a while. So sometimes what you may want to do is have the instruction list, but when you actually run new versions of the processing software, you don't rerun the file download every single time if it's a really big file. And remember to record when the file was downloaded so that you can go back and check the version of the file later when you're trying to figure things out. So that's how you download a file from the internet in r.

----

0:00
여러분이 데이터 세트를 얻을 수 있는 한 가지 방법은 누군가가 실제로 종이에 숫자를 적고 여러분에게 메일을 보내는 것이다. 하지만 이 인터넷 시대에는 아마도 인터넷에서 많은 데이터를 다운로드하게 될 겁니다. 그래서 이 강의는 파일을 다운로드하기 위해 r을 어떻게 사용하는가에 관한 것이다. 포인팅이나 클릭이 아닌 r을 사용하여 파일을 다운로드하는 이유는 다운로드 프로세스가 처리 스크립트에 포함될 수 있기 때문에 데이터가 어떻게 수집되고 생성되었는지에 대한 보다 완전한 그림을 얻을 수 있기 때문이다. 그래서 가장 먼저 기억해야 할 것은 우리가 작업하고 있는 디렉토리가 무엇인지 알아야 한다는 겁니다. 데이터 사이언티스트 툴박스를 선택했다면, CD와 현재 작업 중인 디렉토리들에 대해 조금 배웠을 겁니다. 그리고 디렉토리 내에서 이동하면서요. 우리가 r에 있는 디렉토리들을 다룰 때 두 가지 주요한 명령은 getwd와 setwd가 될 겁니다. 그래서 getwd는 정확히 당신이 기대했던 것을 하고, 그것은 작업 디렉토리를 얻는다. 그것은 당신이 현재 어떤 디렉토리에 있는지 알려준다. 그리고 setwd는 당신이 이동하기를 원하는 다른 작업 디렉토리를 실제로 설정한다. 그래서 여러분이 그렇게 할 수 있는 한 가지 방법은, 실제로 그것을 상대적인 것으로 사용할 수 있다는 겁니다. 예를 들어, 만약 당신이 setwd("../")를 이렇게 한다면, 결국엔 하나의 디렉토리로 이동하게 될 겁니다. 우리가 디렉터리 구조에 대해 이야기할 때, 디렉터리가 슈퍼 센터라면, 현재 디렉터리 위에 있다면, 절대 경로를 사용할 수도 있다. 예를 들어, setwd("/Users/jtleek/data/")를 입력하면 거기서 정확히 지정한 디렉토리로 이동하게 된다.
1:32
그래서 윈도우에서 중요한 차이점은 슬래시 포워드보다는 백슬래시를 사용해야 한다는 것이다. 이것은 맥이나 리눅스 시스템과 반대로 그러니 더 많은 도움이 필요하면 데이터 과학 도구 상자 강의를 확인하십시오. 그래서 우리가 약간의 데이터를 수집하기 전에 하고 싶은 한가지는 그 데이터가 들어갈 수 있는 디렉토리를 만드는 것이다. 파일.존재하며, r의 함수를 말한다. 그래서 만약 당신이 디렉토리에 있고, 당신이 파일을 입력한다면.디렉터리 이름이 존재하면 해당 디렉터리 내에서 검색하여 디렉터리 이름이라는 하위 디렉터리가 있는지 확인하십시오.
2:13
그래서 만약 그것이 존재한다면 그것은 사실로 돌아올 것이고, 만약 그것이 존재하지 않는다면 그것은 거짓으로 돌아올 것이다. 그래서 dir.create는 이렇게 존재하지 않는다면 실제로 디렉토리를 만들 것이다. 여기 데이터 디렉토리가 있는지 확인하는 약간의 코드가 있다. 데이터 하위 디렉터리가 존재하면
2:37
그리고 이것이 사실로 돌아올 것이고, 결국 이것이 거짓이 될 것이고, 아무 일도 일어나지 않을 것이다. 만일 데이터 디렉토리가 존재하지 않는다면, 이것은 거짓을 반환할 것이고, 이 느낌표는 그것을 부정할 것이고, 그래서 그것은 사실일 것이다. 그래서 그것은 데이터라고 불리는 디렉토리를 만들 것이다. 강의 내내 이런 명령을 많이 보게 될 겁니다. 그리고 거기서 존재하지 않는 데이터 디렉토리를 만들 수 있을 겁니다. 그래서 우리가 파일 얘기를 할 때 인터넷에서 데이터를 얻는 가장 큰 방법은 다운로드 입니다.파일 기능, 그리고 다운로드.파일 함수는 인터넷에서 파일을 다운로드한다. 물론 손으로도 할 수 있고, 관심있는 웹사이트로 가서 클릭을 하고 다운로드를 누를 수 있다. 만약 당신이 download.cloud를 이용하여 그것을 한다면, 그것은 실제로 재현성을 향상시킬 것이다. 만약 당신이 그 수업을 들었다면 당신은 내가 무엇을 의미하는지 이해할 것이다. 다운로드 프로세스를 스크립트의 일부로 포함시킨 경우 수행한 모든 작업을 직관적으로 추적하기가 더 쉬울 겁니다.
3:41
중요한 매개 변수는 URL 입니다. 그래서 거기서 데이터를 얻을 수 있을 겁니다. destfile은 해당 데이터가 이동될 대상 파일이며, 그 다음 메서드. 따라서 HTTPS를 다룰 때 이 방법을 지정해야 하는 이유에 대해 잠시 설명하겠습니다.
3:58
그래서 그것은 인터넷에서 제한된 CSV 파일, 엑셀 파일, 많은 다른 파일들로 탭을 다운로드하는데 유용하다. 따라서 파일 형식에 구애받지 않고 다운로드할 수 있는 겁니다. 예를 들어 볼티모어 고정 카메라 데이터를 볼티모어 주변에 설치된 스피드 카메라 입니다. 불행히도 이 카메라가 선생님들을 한 번 이상 속도위반으로 붙잡고 그래서 여러분은 이 자료들을 다운로드해서 어디에 있는지 알고 싶을 겁니다. 만약 여러분이 이 웹사이트의 '내보내기' 버튼을 클릭하면, 여러분은 실제로 다양한 종류의 파일들을 얻게 될 겁니다. 그리고 예를 들면, CSV고 있는데 하나의 파일 여기는 오른쪽에 볼 수 있다면 이러한 종류의 갈 수 있다. 그리고 마우스 오른쪽 버튼을 클릭하면 링크 주소를 복사할 수 있다. 이것이 바로 이러한 카메라 위치로 다운로드할 수 있는 CSV 파일의 링크 주소 입니다.
4:49
그래서 우리가 하는 일은 우리가 복사한 링크를 바로 여기에 놓는 겁니다. 이렇게 fileUrl이라는 변수로 저장해둔 겁니다.
4:59
그리고 우리는 웹사이트에서 수집한 URL 파일을 다운로드 한다. 그리고 우리는 그것을 이 데이터 디렉토리에 넣고, 그것을 camera.csv라고 부르고 싶다. 우리는 .csv를 사용하고 있다. 왜냐하면 그것은 쉼표로 분리된 파일에 사용되는 확장자이기 때문이다. 그리고 우리가 사용할 방법은 컬 입니다. 이 웹 사이트는 https, 보안 웹 사이트이므로 Mac에서 이 작업을 수행할 경우 Curl 방법을 지정해야 제대로 작동할 수 있다. Windows(윈도우)에서 작업하는 경우 Curl(컬러) 방법을 설정할 필요가 없으며 기본 방법은 제대로 작동하며, 따라서 이 데이터 디렉토리에 파일을 나열하면, 이것은 우리가 명령줄 인터페이스에서 보았던 LS 명령과 같은 겁니다. 이제 그 디렉터리에 파일이 하나 있는데, 바로 camera.csv 파일이다.
5:49
인터넷에서 파일을 다운로드하는 중요한 요소는 파일이 변경될 수 있다는 것이다. 예를 들어, 만약 그들이 카메라를 업데이트한다면, 새로운 세트의 카메라들과 우리가 분석하고 있는 자료들은 다를 수 있다. 데이터를 다운로드한 날짜를 추적하려면 날짜 기능을 사용하십시오. 날짜로 할당명령 날짜를 다운로드하면 해당 데이터가 다운로드된 날짜가 나타남 따라서 이러한 데이터가 다운로드되고 날짜를 알면 나중에 문제가 있을 경우 다시 돌아가서 파일의 올바른 버전을 찾을 수 있는지 확인하십시오.
6:22
그래서, 만약 URL이 http로 시작된다면, 당신은 괜찮을 것이다. 비록 url이 윈도우에서 https로 시작된다고 해도 괜찮을 것이다. Mac에서는 https가 있는 경우 method = "curl"을 설정해야 한다. 한가지 기억해야 할 것은 이것이 실제로 밖으로 나가 인터넷에서 파일을 다운로드 하기 때문에 파일의 크기와 인터넷 연결에 따라 시간이 좀 걸릴 수 있다는 것이다. 따라서 때로는 명령 목록을 가지고 있지만, 실제로 새로운 버전의 처리 소프트웨어를 실행할 때 파일 다운로드가 정말 큰 파일이라면 매번 다시 실행되지 않을 겁니다. 그리고 파일을 다운로드한 시기를 기록하여 나중에 문제를 해결하려고 할 때 파일의 버전을 확인할 수 있도록 하십시오. 그래서 인터넷에서 r로 파일을 다운로드하는 겁니다.