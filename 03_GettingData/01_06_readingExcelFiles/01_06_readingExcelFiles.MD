0:00
Some data scientists show a certain snobbery about Excel files. But Excel files are still probably the most widely used format for sharing data. I think the reason is because a lot of people are used to using spreadsheets, so whether you're working in business applications or in science, people know how to use spreadsheets to collect, and put data in, and share it with each other. It's true now, even more than ever, with things like Google spreadsheets, which allow people to share them collaboratively on the internet.
0:25
The problem for you is that when you're analyzing data with a scripting language like R you need to be able to extract the data out of those files so that you can do downstream analyses and processing on them. So we're gonna go back to the Baltimore camera data. I guess I must be getting a lot of speeding tickets lately cuz I've been thinking about this data set a lot. And so now we're gonna actually download the Excel version of this data set. And so in this case the URL is a little bit different. Again you just pick the URL off the website. And then what we're gonna do is we're going to actually download the file as a .xlsx file because that's the extension for Excel files. And so now we've downloaded this file. We began to use download file which remember is agnostic to the file type so it just downloads the file and puts it into this file name that you've stated here. And again we're gonna collect information on when the file was downloaded so that we can know when the analysis was performed.
1:21
So the R library that is useful for this is the xlsx package. There's other packages, XLConnect that can also can be use if you would like to. They might provide a little bit more flexible interface but I like xlsx. So what we do is we actually use the command read.xlsx and we assign it again to the cameraData variable.
1:44
And now we need to pass a couple of parameters so we need to pass the sheetIndex. So we need to say which sheet is the data stored on. And again we're gonna tell it that there's a header line so that the column names are labeled. And so when we load that into R again it looks almost exactly like the data that you got when you read the CSV file and you read it straight out of an Excel file.
2:04
One thing to keep in mind is that you can read specific rows and specific columns. So for example, if you wanna read just the second and third columns and you wanna read just the first through fourth rows, you can actually pass those as variables to colIndex and rowIndex to this file read.xlsx. And you'll actually only read a subset of the Excel file which might be useful if you only wanna abstract a little part of the file that you have. So some further notes that might be useful for you are that you can use write.xlsx. So if you're working with people that like Excel files, you can actually write them back out after your analysis. Share them with people. It's very similar and you pass it the object that you want to write out and the file name and it will write that file out. read.xlsx2 I found is quite a bit faster than read.xlsx. But especially if you're reading subsets of rows, it might be a little bit unstable at least in my experience. XLConnect, as I mentioned, is a lot more flexible for reading, writing and manipulating Excel files. And so if you really need to do a lot of serious processing of Excel files, I've found that XLConnect might be a little bit better. If you're gonna be doing that, the XL Connect vignette is actually a really great place to start. It has lot of information about how you can do all sorts of different things. How you can manipulate and create files directly from R. In general, and for the purposes of this class but also the purposes of most analyses it's a little bit faster and easier to read files if you store them as comma separated, or tab separated flat files. They're also a little bit easier to distribute, as not everybody has Excel. It's not necessarily as cross-platform as using something like a plain text file, with just comma separated or tab separated values.

----

0:00
일부 데이터 과학자들은 엑셀 파일에 대해 어떤 속물근성을 보여준다. 그러나 엑셀파일은 여전히 데이터 공유에 가장 널리 사용되는 형식이다. 그 이유는 많은 사람들이 스프레드시트를 사용하는 것에 익숙하기 때문이라고 생각한다. 그래서 당신이 비즈니스 응용프로그램에서 일하든 과학에서 일하든 사람들은 스프레드시트를 사용하여 데이터를 수집하고, 넣는 방법을 알고 있고, 서로 공유한다. 구글 스프레드시트와 같은 것들이 사람들이 인터넷에서 함께 공유할 수 있게 하는 것은 그 어느 때보다도 지금 사실이다.
0:25
문제는 R과 같은 스크립팅 언어로 데이터를 분석할 때 다운스트림 분석과 처리를 할 수 있도록 해당 파일에서 데이터를 추출할 수 있어야 한다는 겁니다. 그럼 볼티모어 카메라 데이터로 돌아가서 나는 이 데이터 세트를 많이 생각했기 때문에 최근에 과속 티켓을 많이 얻었나 봐. 이제 이 데이터 세트의 엑셀 버전을 다운로드 할 겁니다. 그래서 이 경우 URL은 조금 다르다. 다시 당신은 웹사이트에서 URL을 선택하기만 하면 된다. 그리고 나서 우리가 할 일은 파일을 .xlsx 파일로 다운로드 하는 겁니다. 왜냐하면 그게 엑셀 파일의 확장자거든요. 그래서 우리는 이 파일을 다운로드했다. 우리는 파일 형식에 구애받지 않는다는 것을 기억하는 다운로드 파일을 사용하기 시작했고, 그래서 그것은 단지 파일을 다운로드해서 당신이 여기서 말한 파일 이름에 넣는다. 그리고 다시 우리는 언제 분석이 수행되었는지 알 수 있도록 파일이 다운로드되었는지에 대한 정보를 수집할 것이다.
1:21
그래서 이것에 유용한 R 도서관은 xlsx 패키지 입니다. 다른 패키지인 XLConnect도 있는데, 원한다면 사용할 수 있다. 그들은 좀 더 유연한 인터페이스를 제공할지도 모르지만 나는 xlsx를 좋아한다. 그래서 우리는 read.xlsx 명령을 실제로 사용하고 다시 camerData 변수에 할당한다.
1:44
이제 몇 가지 매개 변수를 통과해야 하므로 SheetIndex를 통과해야 한다. 그래서 우리는 어떤 시트가 저장된 데이터인지 말해야 한다. 그리고 다시 한 번, 우리는 그 열 이름들에 라벨을 붙이도록 머리줄이 있다는 것을 말할 것이다. R에 다시 로드하면 CSV 파일을 읽고 엑셀 파일에서 바로 읽었을 때
2:04
기억해야 할 한 가지는 특정 행과 특정 열을 읽을 수 있다는 것이다. 예를 들어, 두 번째와 세 번째 열만 읽고 첫 번째에서 네 번째 행까지만 읽으려면, 이 열들을 colIndex와 rowIndex에 대한 변수로 전달하면 됩니다 read.xlsx. 엑셀의 하위 집합만 읽으면 되는 겁니다. 파일의 일부만 추상화하면 도움이 될 겁니다. 그래서 당신에게 유용할 수 있는 몇 가지 추가 메모는 write.xlsx를 사용할 수 있다는 겁니다. 엑셀 파일을 좋아하는 사람들과 함께 작업한다면, 분석 후에 다시 쓸 수 있을 겁니다. 사람들과 그것들을 공유하라. 그것은 매우 비슷하고 당신이 쓰고자 하는 객체와 파일명을 전달하면 그것은 그 파일을 쓸 것이다. Read.xlsx2 내가 발견한 것은 read.xlsx보다 꽤 빠르다는 것이다. 그러나 특히 당신이 행의 하위 집합을 읽는다면, 그것은 적어도 내 경험에서는 약간 불안정할 수 있다. 내가 언급했듯이 XLConnect는 엑셀 파일을 읽고, 쓰고, 다루는 데 있어 훨씬 더 유연하다. 엑셀 파일을 많이 처리해야 한다면 XLConnect가 더 나을 겁니다. 만약 당신이 그렇게 할 것이라면, XL Connect vignet은 사실 시작하기에 정말 좋은 장소 입니다. 그것은 당신이 어떻게 모든 종류의 다른 것들을 할 수 있는지에 대한 많은 정보를 가지고 있다. R에서 직접 파일을 조작하고 생성하는 방법. 일반적으로 이 클래스의 목적뿐만 아니라 대부분의 분석 목적도 쉼표로 구분하거나 플랫 파일을 탭으로 구분하여 저장하면 파일을 읽는 것이 약간 더 빠르고 쉽다. 모두가 엑셀을 가지고 있는 것은 아니기 때문에, 그것들은 또한 배포하기가 약간 쉽다. 그것은 쉼표로 구분되거나 탭으로 구분된 값을 가진 평범한 텍스트 파일과 같은 것을 사용하는 것처럼 반드시 교차 플랫폼이 될 필요는 없다.