0:00
This lecture is about reading XML. So if you don't know about XML, it's Extensible Markup Language, is what it stands for. So it's frequently used to score structured data. It's particularly widely used in internet applications. So you'll see it a lot when you're doing things like web scraping or trying to get data from an internet API or trying to download data from say, open data of websites, say like an open government website. So, extracting HTML, XML is actually the basis for most of the web-scraping that you'll see. There are two components to an XML file. There's the markup. That's the labels that give the text structure. So you can imagine if you just started typing, you would end up with sort of an unstructured text file. The markup is the way that you add labels so that the file ends being structured. And then the content is the actual text that you type in, in between sort of the labels that give the structure to the text. So to be a little bit more concrete, we'll talk about tags, elements and attributes.
0:58
So tags correspond to the labels, that there are labels that are going to be applying to particular parts of the text so that it will be structured. So, there are start tags. And so, start tags look like this. So, they start with an open caret on one side and then they have a, a phrase and then a closed caret on the other side. So, you'll have that at the beginning of a certain part of the text. So, that will start them, that text as a, a labelled section called section. And then it ends with an end tag which looks like this. It has the same phrase as before, but it starts with a forward slash inside of the two carets.
1:37
And so the empty tags are tags that correspond to lines where you don't necessarily need both an open and then a close tag to deliminate a certain part of a text. You might just want to denote one specific line, say, as a line break. And so what you do is, you have the same sort of structure. Only you have the forward slash just over here at the right end. So elements are specific examples of tags. So, for example, one element of the XML markup could be, the tag greeting, with the end tag greeting over here on the right hand side and in between it the content, the hello world.
2:13
So, attributes are components of the label. So, you can actually add to the tags components. And so, for example, you might have an image tag. So, what you might want to have corresponding to that image is an attribute that's the source. That's where the image is actually coming from. And then an alternate phrase for that tag, and that could be instructor, for example.
2:36
So another example here is suppose you have a tag that's a step tag, and you might have multiple steps, so tag number step number one might be tagged with number equal 1 and then two and then this is number three step three. And then it needs to end with an end tag just like it did before. If you want to know a lot more about XML and it's probably Probably a good idea before doing a whole bunch more with this lecture, if you could go and see, the Wikepedia entry on XML, which is actually quite comprehensive and nice.
3:04
So this is an example XML file. It's a little bit hard to see, but you can see it okay if you go actually to the web link here at the bottom of the page. And so the idea here is you have a text file, and that text file has lots of tags and content in it. So for example here you have a tag that says food and then here is a close tag for that tag that says food down here. So you can see they're indented at the same level within this file. And then for this particular food element you actually have a name, so there's the open tag for name and there's the close tag for name, and this particular. Element is named sort of Belgian Waffle, delicious.
3:46
And then there's other tags that correspond to other components of this particular food element. And then you go down and there's another food elements with another names and so forth. So that's what an xml file look at. It looks like and I encourage you to go look the the bigger version of that when you go to that web link.
4:03
So you can read the file into R, you can do this with the XML package so we're loading the XML package all caps XML. And then you give it the url. So in this case, we're going to give it the url from the previous XML file we were looking at on that previous screen. And then we can use the function XML three parts to parse out that XML file. So what this does is. It loads the document into a memory, into a R memory in a way that you can then parse it and get access to different parts of it. So, within R, it's still a structured object, so we have to be able to use different functions to access different parts of that object. So, the root node you can get with XML root. And so what that is, is it's sort of the wrapper, you can think of it as the wrapper for the entire document. And so if you execute this xml root command, you'll have access to that particular element to that xml file. And then if you want to get the name out, you can actually use the xmlname applied to that node to get the name out, in this case, it's the breakfast menu.
5:12
You can also look at the names of the root node. And so, when you do names of the root node what it's actually telling you is what all the nested elements within that root node are. So, the root node wraps the whole document and the whole document is a breakfast menu. And then there are five different breakfast items on this menu, and each one is wrapped within a food element. So, you get five food elements, if you look at names of the root node. So,
5:39
the next thing that you could use is actually directly access parts of the XML document. And you can do it in a little bit in the same that way you access a list in R. And so, for example, if you want to look at. You, you have this root node element that we've extracted. And we can look at the first component of that or the first element of that and we do it by using double brackets here. That's how you access the first element, say in a list. And so, what you get out, actually, is the first food element, like this. So it contains the food tags, and it also contains all the information about the first food element. Then, if you want to keep drilling down into smaller and smaller parts of the XML document, you can do sub-setting, just like you do with lists. So first, this exit rootNode and the first bracket one, will again give you this.
6:23
Element here with the entire food component and then if you want to take the first element of that, you'll just repeat the process again and then you'll be looking at just the name the belgian waffles because that's the first subcomponent of the first subcomponent.
6:39
You can actually programmatically extract different parts of the file. So you can do that with the XML Xsupply command, and so what you do is you pass that a parsed XML object and then you tell it what function you like to apply; so in this case XML value. So what that's going to do is, it's going to loop through all of the elements of the root node and get the XML value And by default this is going to do this recursively. So, if you apply it in this way, since rootNode contains the entire document, it's going to go through and get every single value of every sing tagged element in the entire document. And so you just get a bunch of text all strung together that's all the text that was in that document.
7:20
You might be a little bit more specific and get a specific component of the document. And you can do that using the XPath language, so this a whole other language that you have to learn in addition to XML to be able to access the data. But if you learn just a few of the components then you'll be a long way along the way.
7:40
I'm going to talk a little bit about this, but there's actually really nice set of lecture notes that are available here that go into this in a little bit more depth, if you find yourself a little bit. Lost after this lecture.
7:52
So the first thing that you're going to be looking at is the top level node of each element, and that you get with a forward slash node. The node at any level is double slash node. And then you can actually extract specific nodes with specific attributes. And we'll talk about how to do that in the next couple of slides. [SOUND] So the first thing that you're going to want to be able to do is get the items on the menu and their prices and so the way that we're going to do that is we're again going to use this xpathSApply but now we're going to be a little bit more targeted about which data we're going to be extracting. So we're giving you, again, [INAUDIBLE] the rootNode. That's the entire document, and so then what we're going to be doing is we're going to be using This xpack element here is //name. And so, what that's going to do is it's going to go through and get all of the nodes that correspond to an element with title name and then it's going to get the xmlvalue of those nodes. So, what it's going to do is it's going to take out basically all of the elements of that XML file that are tagged with name and so you can see, you end up with the names of all of the items on the menu.
8:59
You can also do the same thing. You send the exact same rootNode to xpathSApply, only now you can say I actually just want the nodes that correspond to price. And again I want their xmlValue. And so it will plot out the xmel values which the prices of the values and now we extract from that xmel file the names of the menu items as well as their prices.
9:22
To give you an example of, it's a little more complicated I am actually going to use a website of the Baltimore Ravens which is an American football team that is based here on Baltimore. So, this the homepage of that team on ESPN. Which is a sports channel in the U.S. and so what we're going to do is actually look at the source code. So, if you right click on the page and say view source what you'll see is a source document that looks like this. It's actually quite complicated. That's the source code that actually demonstrates, that's process to show you the website that you actually see when you go navigate your browser to that website. So we're going to actually drill into this website source code and see if we can extract some information. So again I'm going to pass the file URL. This is the URL of that website, if you go back to the previous page. So now, since I'm parsing an HTML file, instead of an XML file, I'm going to use HTML tree parse instead of XML tree parse. Um,the difference is our, it's different enough you want to use HTML tree parse when you're parsing an HTML file. And then I'm going to pass the command use internal equals true, so that I can get all the different nodes inside of that, that file. So now what I'm going to do is, I'm again going to use the xpathSApply to programatically extract some components of this document. So I'm going to start with the whole document again. And now what I'm going to try to do is, I'm going to again extract the XML value to the value inside of certain elements. But I want to find very specific kinds of elements. So here's what I'm going to do. I'm going to look for elements. That are list items li, and that have a particular class. So they have class equal to score. And so, what this is going to do is it's going to go through the entire document, and any time it sees a tag that is a, a list item, it's going to check and see if it's class is score. And if it's class is score it'll return the XML value. So it turns out if you go back to this website and you look very very carefully, That you can see for example there are these list items and the class in this class is equal to the team name and so the next element that I'm going to be extracting on this page is actually the team name. So it's the same thing. I look for a list item with class equal to team name and it will extract those team names. So the way this works is you go to the website and you find the tag and any attributes that you want to extract, and then you need to write them into this xpath language to extract only the data for those specific elements with xpath, as applied. So, if I do this, I end up with the scores for each of the games and the teams. So, I've scraped from that website information directly using
12:09
This is a very brief introduction to XML. The xml packaging r and xml in general. If you go and check out the xml tutorials for the xml package there's a short one that's really good and a long one that's extremely extensive and should only be read after reading the short one so you get an idea of what is going on. And then there's really outstanding guide to the XML package that's linked to here as well that will give you a lot of information about how you can use XML to programatically extract information from websites.


----


0:00
이 강의는 XML을 읽는 것에 관한 겁니다. XML에 대해 모르신다면, 확장 가능한 마크업 언어 입니다. 그래서 구조화된 데이터를 채점하는 데 자주 사용된다. 그것은 특히 인터넷 어플리케이션에서 널리 사용된다. 웹 스크랩이나 인터넷 API에서 데이터를 얻으려고 하거나 오픈 정부 웹사이트처럼 따라서 HTML을 추출하는 것, XML은 실제로 여러분이 보게 될 대부분의 웹 스크랩의 기초가 된다. XML 파일에는 두 가지 구성 요소가 있다. 여기 마크업. 그것이 텍스트 구조를 나타내는 라벨이다. 만약 여러분이 방금 입력을 시작한다면, 여러분은 구조화되지 않은 텍스트 파일로 끝날 것이라고 상상할 수 있을 겁니다. 마크업은 파일 구조가 끝나도록 레이블을 추가하는 방법이다. 그리고 내용은 여러분이 입력하는 실제 텍스트입니다. 텍스트에 구조를 부여하는 라벨의 종류 사이에. 좀 더 구체적으로 말하자면, 태그, 요소, 특성에 대해 이야기 할 겁니다.
0:58
그래서 태그는 라벨과 일치하고, 텍스트의 특정 부분에 적용될 라벨들은 구조화 될 것이다. 그래서, 시작 꼬리표가 있다. 시작 태그는 이렇게 생긴 겁니다. 그래서 그들은 한쪽에 열린 보호막으로 시작해서 한 구절과 다른 쪽에 닫힌 보호막을 가지고 있다. 자, 여러분은 그것을 본문의 특정 부분의 시작 부분에 있게 될 겁니다. 그래서, 그렇게 하면, 그 텍스트는 a로, 섹션이라 불리는 섹션이 시작될 것이다. 그리고 이렇게 생긴 끝자락으로 끝이 난다. 그것은 이전과 같은 어구를 가지고 있지만, 그것은 두 가지 주의사항의 안쪽에 있는 전방 슬래시로부터 시작된다.
1:37
따라서 빈 태그는 텍스트의 특정 부분을 삭제하기 위해 반드시 열린 태그와 닫힌 태그가 필요하지 않은 선에 해당하는 태그입니다. 당신은 단지 하나의 특정 라인을, 예를 들어, 줄 바꿈으로써 표현하기를 원할 수도 있다. 그래서 여러분이 하는 것은, 같은 종류의 구조를 가지고 있다는 겁니다. 여기 오른쪽 끝에 슬래시만 있어. 그래서 요소들은 태그의 특정한 예들이다. 예를 들어, XML 마크업의 한 요소는 태그 인사말입니다. 여기 오른쪽에 있는 끝 태그 인사말과 내용, 그리고 그 사이에 있는 인사말입니다.
2:13
따라서 속성은 레이블의 구성요소다. 따라서 태그 구성 요소에 예를 들어, 이미지 태그를 가지고 있을 겁니다. 그래서, 이 이미지에 해당하는 것이 바로 그 원천인 속성입니다. 그것이 바로 이미지가 실제로 나오는 곳이다. 그리고 그 태그에 대한 다른 구절, 예를 들어 강사일 수도 있다.
2:36
여기 또 다른 예가 여러분이 단계 태그인 태그를 가지고 있고 여러 단계가 있을 수 있기 때문에 태그 번호 1단계는 숫자가 1이고 그 다음 2단계는 3단계라고 가정하는 겁니다. 그리고 그것은 전에 그랬던 것처럼 엔드 태그로 끝날 필요가 있다. XML에 대해 더 알고 싶으시다면, 아마도 이 강의로 더 많은 것을 하기 전에, 만약 여러분이 가서 볼 수 있다면, 사실 꽤 종합적이고 좋은 XML에 대한 와이크피디아 항목 입니다.
3:04
이것은 XML 파일의 예 입니다. 보기 조금 어렵긴 하지만, 여기 페이지 하단의 웹 링크로 가면 괜찮아. 여기서의 아이디어는 여러분이 텍스트 파일을 가지고 있고, 그 텍스트 파일에는 많은 태그와 내용이 들어있다는 겁니다. 예를 들어, 여기 음식이라고 적힌 꼬리표가 있고, 여기 아래에 음식이라고 적혀있는 꼬리표가 있다. 이 파일 안에서 같은 수준으로 들여져 있는 것을 볼 수 있을 겁니다. 그리고 이 특정 음식 요소에는 실제로 이름이 있고, 이름에는 열린 태그가 있고, 이름에는 근접한 태그가 있고, 이 부분은 특히 그렇다. 원소는 벨기에 와플의 일종으로, 맛있다.
3:46
그리고 이 특정 식품 요소의 다른 구성 요소에 해당하는 다른 태그도 있다. 그리고 내려가서 다른 이름들을 가진 다른 음식 요소들이 있다. 그래서 그것이 xml 파일이 보는 것이다. 웹 링크에 갈 때 좀 더 큰 버전으로 가보십시오.
4:03
이 파일을 R로 읽으면 XML 패키지로 할 수 있기 때문에 XML 패키지를 모두 로드하고 URL을 지정하십시오. 이 경우, 이전 화면에서 보고 있던 이전 XML 파일의 url을 그런 다음 XML 함수를 사용하여 XML 파일을 분석하십시오. 그래서 이게 무슨 일이냐면. 그것은 문서를 메모리에 로드하고, R 메모리로 로딩하여 당신이 문서를 파싱하고, 그것의 다른 부분에 접근할 수 있도록 한다. 그래서, R 내에서, 그것은 여전히 구조화된 개체 입니다. 그래서 우리는 그 개체의 다른 부분에 접근하기 위해 다른 기능을 사용할 수 있어야 합니다, 따라서 XML 루트로 얻을 수 있는 루트 노드. 그래서 그게 뭐냐면, 이건 일종의 포장지라는 겁니다. 여러분은 그걸 전체 문서의 포장지라고 생각할 수 있을 겁니다. 이 xml 루트 명령을 실행하면 해당 xml 파일에 대한 특정 요소에 액세스할 수 있으며, 그리고 만약 여러분이 이름을 끄집어내고 싶다면, 그 노드에 적용된 xmlname을 사용해서 이름을 끄집어내면 됩니다, 이 경우에는, 아침식사 메뉴 입니다.
5:12
루트 노드의 이름도 볼 수 있다. 그래서 루트 노드의 이름을 지정할 때 실제로 이 루트 노드 내의 모든 중첩된 요소가 무엇인지 알 수 있다. 그래서, 루트 노드는 전체 문서를 감싸고 전체 문서는 아침식사 메뉴다. 그리고 이 메뉴에는 다섯 가지 다른 아침 식사가 있는데, 각각은 식품 성분 안에 싸여 있다. 뿌리의 이름을 보면 다섯가지 음식 요소를 얻을 수 있다. 그렇게
5:39
다음으로 사용할 수 있는 것은 실제로 XML 문서의 일부분에 직접 액세스하는 것이다. R에 있는 목록에 액세스하는 것과 같은 방식으로 수행할 수 있습니다. 예를 들어, 우리가 추출한 루트 노드 요소가 있는데 그리고 우리는 그것의 첫 번째 요소나 그것의 첫 번째 요소를 볼 수 있고, 여기서 이중 괄호를 사용하여 그것을 할 수 있다. 목록에서 첫 번째 요소에 액세스하는 방법. 그래서, 사실, 여러분이 얻는 것은, 이런 최초의 음식 요소 입니다. 그래서 그것은 음식 태그를 포함하고, 또한 첫 번째 음식 요소에 대한 모든 정보를 포함하고 있다. 그런 다음 XML 문서의 더 작고 더 작은 부분으로 계속 드릴다운하려면 목록을 사용하는 것처럼 하위 설정을 수행하십시오. 먼저, 이 출구 루트노드와 첫 번째 브래킷이 다시 이것을
6:23
식품 성분 전체를 가지고 여기 있는 요소들, 그리고 그 첫 번째 요소를 가지고 싶다면, 과정을 다시 한 번 반복하기만 하면 됩니다, 그리고 여러분은 첫 번째 하위 구성요소의 첫 번째 하위 구성요소인 벨리안 와플의 이름만 보게 될 겁니다.
6:39
당신은 실제로 파일의 다른 부분들을 프로그래밍 방식으로 추출할 수 있다. 따라서 XML X 공급 명령을 사용하여 이 작업을 수행할 수 있으며, 구문 분석된 XML 개체를 전달한 다음 어떤 기능을 적용하고자 하는지 알려줍니다. 따라서 이 경우 XML 값입니다. 즉, 루트 노드의 모든 요소를 순환하여 XML 값을 얻을 수 있게 되는 겁니다. 기본적으로 이 작업은 재귀적으로 이루어질 겁니다. 따라서, 이런 식으로 적용한다면, rootNode는 전체 문서를 포함하므로, 전체 문서에서 모든 노래에 태그된 요소의 모든 가치를 파악하게 될 겁니다. 그래서 당신은 단지 한 무더기의 텍스트를 모두 함께 묶어서 그 문서에 있는 모든 텍스트들을 얻을 수 있다.
7:20
당신은 좀 더 구체적이고 문서의 특정 구성요소를 얻을 수 있다. 그리고 당신은 그것을 XPath 언어를 사용하여 할 수 있습니다, 그래서 이것은 데이터에 접근하기 위해 XML과 함께 배워야 하는 완전히 다른 언어 입니다. 하지만 몇 가지 구성 요소만 배우면 큰 도움이 될 겁니다.
7:40
이 문제에 대해 조금 말씀드리려고 합니다만, 여기 있는 강의 노트들은 좀 더 깊이 들어가 볼 수 있고, 만약 여러분 자신을 좀 더 깊이 있게 될 겁니다. 이 강의가 끝나고 길을 잃었어.
7:52
먼저 각 요소의 최상위 노드와 슬래시 노드를 사용하여 어떤 레벨의 노드는 이중 슬래시 노드다. 그런 다음 특정 특성을 가진 특정 노드를 추출할 수 있으며, 그리고 다음 몇 장의 슬라이드에서 [SOUND] 그래서 여러분들이 제일 먼저 하실 일은 메뉴와 가격에 있는 아이템을 받는 겁니다. 그래서 우리가 할 일은 xpathSApply를 다시 사용할 것이지만, 이제는 우리가 추출할 데이터에 대해 좀 더 타겟이 될 겁니다. 다시 한 번 [INAUDIBLE] 루트를 드리지요. 이것이 전체 문서 입니다. 그래서 우리는 xpack 요소를 사용할 겁니다. //name 입니다. 그래서, 그것이 할 일은 그것이 이름을 가진 요소에 해당하는 모든 노드를 통과해서 얻은 다음 그 노드의 xmlvalue를 얻게 될 겁니다. 그래서, 이것이 할 일은 기본적으로 이름이 적힌 XML 파일의 모든 요소들을 제거할 것이고, 그러면 여러분은 메뉴에 있는 모든 항목의 이름을 볼 수 있을 겁니다.
8:59
너도 같은 일을 할 수 있어. 동일한 rootNode를 xpathSApply에 보내면, 오직 지금 당신은 오직 나는 가격에 상응하는 노드를 원한다고 말할 수 있다. 그리고 다시 나는 그들의 xmlValue를 원한다. 그래서 그것은 그 가치들의 가격이 얼마인지 그리고 이제 우리는 그 xmel 파일에서 메뉴 항목의 이름과 그 가격들을 추출할 것이다.
9:22
예를 들면, 좀 더 복잡한 것 같은데, 사실 볼티모어에 기반을 둔 미국 축구팀 볼티모어 레이븐스의 웹사이트를 이용하려고 한다. 그래서 ESPN에 있는 그 팀의 홈페이지 입니다. 미국의 스포츠 채널인 만큼 우리가 할 일은 그래서, 만약 당신이 페이지를 마우스 오른쪽 버튼으로 클릭하고 보기 소스라고 말한다면, 당신은 이렇게 보이는 원본 문서를 보게 될 것이다. 그것은 사실 꽤 복잡하다. 이것이 바로 여러분이 그 웹 사이트를 탐색할 때 실제로 볼 수 있는 웹 사이트를 보여주는 소스 코드 입니다. 그래서 우리는 이 웹사이트의 소스 코드를 자세히 살펴보고 우리가 정보를 추출할 수 있는지 알아보려고 한다. 그래서 다시 파일 URL을 넘겨야겠다. 이전 페이지로 돌아가면 이 웹 사이트의 URL이 된다. 그래서 이제 HTML파일을 파싱하는 대신 XML파스 대신 HTML트리 파스를 사용할 겁니다. 음, 차이점은 HTML 파일을 구문 분석할 때 HTML 트리 파스를 사용하고 싶을 정도로 다르다는 거야 그 다음 internal equals true 명령을 전달해서 그 안에 있는 모든 다른 노드들을 그래서 이제, xpathSApply를 사용하여 이 문서의 일부 구성 요소를 프로그래밍할 겁니다. 그래서 나는 다시 전체 서류로 시작할 것이다. 이제 제가 하려고 하는 것은, XML 값을 특정 요소들 내부의 값으로 다시 추출하는 겁니다. 하지만 나는 매우 특정한 종류의 요소들을 찾고 싶다. 자, 이것이 내가 할 일이다. 나는 요소들을 찾아볼 것이다. 그것은 목록 항목 li 이고, 그것은 특별한 클래스를 가지고 있다. 그래서 그들은 점수를 매길 수 있는 학급이 있다. 그래서, 이것이 할 일은 전체 문서를 통해서, 그리고 그것이 목록 항목인 태그를 볼 때마다, 그것이 점수가 매겨지는지 확인하게 될 겁니다. 그리고 만약 그것이 점수가 매겨진다면 그것은 XML 값을 반환할 것이다. 이 웹사이트로 돌아가서 매우 주의깊게 살펴보면, 예를 들어 목록 항목이 있고 이 강의의 강의는 팀 이름과 같기 때문에 이 페이지에서 추출할 다음 요소는 실제로 팀 이름 입니다. 그래서 같은 것이다. 나는 팀 이름과 같은 반의 목록 항목을 찾았고 그것은 그 팀 이름을 추출할 것이다. 이 기능이 작동하는 방법은 웹 사이트에 가서 태그와 추출할 속성을 찾은 다음 이 xpath 언어로 기록하여 적용된 대로 xpath를 사용하여 특정 요소에 대한 데이터만 추출하십시오. 그래서 이렇게 하면 게임마다 점수를 매기고. 그래서 그 웹사이트 정보를
12:09
이것은 XML에 대한 매우 간단한 소개다. 일반적으로 xml 패키징 r과 xml. 만약 당신이 xml 패키지에 대한 xml 튜토리얼을 살펴본다면, 정말 좋고 긴 튜토리얼이 있는데, 그것은 매우 광범위하고, 짧은 튜토리얼을 읽은 후에만 읽혀져야 하기 때문에 당신은 무슨 일이 일어나고 있는지 알 수 있다. 그리고 여기 링크된 XML 패키지에 대한 매우 뛰어난 가이드가 있는데, 이 가이드는 XML을 사용하여 웹 사이트에서 정보를 프로그래밍할 수 있는 방법에 대한 많은 정보를 제공한다.